{"ast":null,"code":"import _regeneratorRuntime from\"/Users/migleczigergo/Projects/Codecademy-Full-StackEngineer/JavaScript/Reddit/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/migleczigergo/Projects/Codecademy-Full-StackEngineer/JavaScript/Reddit/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';import'./post.css';import Like from'./like/like';import Text from'./text/text';import comment from'../../../comment.png';import Media from'./media/media';import Comments from'./comments/comments';import{memes}from'../../../app/memesSlice';import{useDispatch}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Post(_ref){var au=_ref.au,text=_ref.text,img=_ref.img,id=_ref.id,likeColor=_ref.likeColor,showComment=_ref.showComment,likes=_ref.likes,permalink=_ref.permalink,comments=_ref.comments;var dispatch=useDispatch();var getComments=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(permalink){var response,body,comments,i,_comment;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://www.reddit.com\".concat(permalink,\".json?limit=25\"));case 2:response=_context.sent;_context.next=5;return response.json();case 5:body=_context.sent;//console.log(body)\ncomments=[];for(i=0;i<body[1].data.children.length;i++){_comment=void 0;if(body[1].data.children[i].data.body_html){_comment={author:body[1].data.children[i].data.author,text:body[1].data.children[i].data.body_html.substr(31,body[1].data.children[i].data.body_html.length-54)};}else{_comment={author:body[1].data.children[i].data.author,text:body[1].data.children[i].data.body_html};}if(_comment.text){if(!_comment.text.includes(\"&\")){comments.push(_comment);}}}_context.next=10;return Promise.all(comments);case 10:return _context.abrupt(\"return\",_context.sent);case 11:case\"end\":return _context.stop();}},_callee);}));return function getComments(_x){return _ref2.apply(this,arguments);};}();function toggleComment(e){var id=e.target.getAttribute('value');var hide=true;if(showComment===true){hide=false;}//console.log(e.target.getAttribute('value'))\nif(comments.length<=0){getComments(permalink).then(function(comments){dispatch(memes.actions.addComment({id:id,comments:comments}));});}dispatch(memes.actions.toggleComment({id:id,comment:hide}));}return/*#__PURE__*/_jsxs(\"div\",{id:id,className:'post-container',children:[/*#__PURE__*/_jsxs(\"div\",{className:'like-text',children:[/*#__PURE__*/_jsx(Like,{id:id,likeColor:likeColor,likes:likes}),/*#__PURE__*/_jsx(Text,{text:text,au:au})]}),/*#__PURE__*/_jsx(Media,{src:img}),/*#__PURE__*/_jsx(\"div\",{className:\"right-align\",children:/*#__PURE__*/_jsx(\"img\",{src:comment,alt:'comment',className:'comment-icon',value:id,onClick:function onClick(e){return toggleComment(e);}})}),/*#__PURE__*/_jsx(Comments,{hidden:showComment,comments:comments,id:id})]});}export default Post;","map":{"version":3,"names":["React","Like","Text","comment","Media","Comments","memes","useDispatch","Post","au","text","img","id","likeColor","showComment","likes","permalink","comments","dispatch","getComments","fetch","response","json","body","i","data","children","length","body_html","author","substr","includes","push","Promise","all","toggleComment","e","target","getAttribute","hide","then","actions","addComment"],"sources":["/Users/migleczigergo/Projects/Codecademy-Full-StackEngineer/JavaScript/Reddit/my-app/src/components/posts/post/post.js"],"sourcesContent":["import React from 'react';\nimport './post.css'\nimport Like from './like/like';\nimport Text from './text/text';\nimport comment from '../../../comment.png'\nimport Media from './media/media';\nimport Comments from './comments/comments';\nimport { memes } from '../../../app/memesSlice';\nimport { useDispatch } from 'react-redux';\n\nfunction Post({au, text, img, id, likeColor, showComment, likes, permalink, comments}) {\n\n  const dispatch = useDispatch();\n\n  const getComments = async (permalink) => {\n    const response = await fetch(`https://www.reddit.com${permalink}.json?limit=25`);\n    const body = await response.json();\n    //console.log(body)\n    const comments = [];\n    for (let i = 0; i < body[1].data.children.length; i++) {\n      let comment;\n      if(body[1].data.children[i].data.body_html){\n        comment = {\n          author: body[1].data.children[i].data.author,\n          text: body[1].data.children[i].data.body_html.substr(31, body[1].data.children[i].data.body_html.length-54)\n        };\n      }else{\n        comment = {\n          author: body[1].data.children[i].data.author,\n          text: body[1].data.children[i].data.body_html\n        };\n      }\n      \n      if(comment.text){\n        if(!comment.text.includes(\"&\")){\n        comments.push(comment);\n        }\n      }\n     \n    }\n    return await Promise.all(comments);\n  }\n\n  function toggleComment(e){\n    const id = e.target.getAttribute('value');\n    let hide = true;\n    if(showComment === true){\n      hide = false;\n    }\n    //console.log(e.target.getAttribute('value'))\n    if(comments.length <=0){\n      getComments(permalink).then( comments => {\n        dispatch(memes.actions.addComment({id: id, comments: comments}))\n      }\n      )\n    }\n    dispatch(memes.actions.toggleComment({id: id, comment: hide}));\n  }\n\n    return (\n      <div id={id} className={'post-container' }>\n          <div className={'like-text' }>\n            <Like id={id} likeColor={likeColor} likes={likes}/> \n            <Text text={text} au={au}/>\n          </div>\n          <Media src={img}/>\n          <div className='right-align'>\n              <img src={comment} alt={'comment'} className={'comment-icon'} value={id} onClick={e => toggleComment(e)}></img>\n          </div>\n          <Comments hidden={showComment} comments={comments} id={id} />\n      </div>\n    );\n  }\n  \n  export default Post;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}